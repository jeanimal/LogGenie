# LogGenie Deployment Guide

## Quick Fix for Replit Deployment

The deployment was failing because the server looks for static files in `/public` but Vite builds them to `/dist/public`. Here's how to fix it:

### Option 1: Manual Fix (Immediate Solution)

Run these commands in the Replit Shell before deploying:

```bash
# Build the application
npm run build

# Copy static files to correct location
cp -r dist/public ./public
```

Then deploy normally through Replit Deployments.

### Option 2: Use Deployment Script

We've created a deployment script that handles everything automatically:

```bash
# Run the deployment script
./deploy.sh
```

This script will:
1. Clean previous builds
2. Build frontend with Vite
3. Build backend with esbuild
4. Copy static files to the correct location
5. Verify the build

### Manual Deployment Steps

If you prefer to run commands manually:

1. **Clean previous builds**
   ```bash
   rm -rf dist/ public/
   ```

2. **Build frontend**
   ```bash
   npx vite build
   ```

3. **Build backend**
   ```bash
   npx esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist
   ```

4. **Copy static files**
   ```bash
   cp -r dist/public ./public
   ```

5. **Test production server** (optional)
   ```bash
   NODE_ENV=production node dist/index.js
   ```

### File Structure After Build

After successful build, your project should have:

```
/dist/
  ├── index.js          # Backend server bundle
  └── public/           # Built frontend files
/public/                # Static files (copied from dist/public)
  ├── index.html
  └── assets/
```

## Replit Deployment Configuration

The `.replit` file is configured for:
- **Build command**: `npm run build`
- **Start command**: `npm run start`
- **Port**: 5000 (mapped to external port 80)

## Environment Variables

Make sure these environment variables are set in Replit Deployments:

- `DATABASE_URL` - PostgreSQL connection string
- `OPENAI_API_KEY` - OpenAI API key for anomaly detection
- `SESSION_SECRET` - Session encryption key (auto-generated by Replit)
- `REPL_ID` - Replit project ID (auto-set)
- `REPLIT_DOMAINS` - Deployment domains (auto-set)

## Database Setup

The PostgreSQL database will be automatically provisioned. No manual setup required.

## Troubleshooting

### Common Issues:

1. **"Could not find build directory" error**
   - Solution: Run `cp -r dist/public ./public` before deployment

2. **Static files not loading**
   - Ensure `/public` directory exists with built assets
   - Check that `index.html` is in `/public/`

3. **Database connection errors**
   - Verify `DATABASE_URL` environment variable is set
   - Check that PostgreSQL module is enabled in `.replit`

### Health Check

The deployment includes a health check endpoint. After deployment, verify it works:
```
https://your-deployment-url.replit.app/health
```

## Production Features

LogGenie includes:
- ✅ Comprehensive log analytics with cybersecurity focus
- ✅ AI-powered anomaly detection using OpenAI
- ✅ Multi-tenant company separation
- ✅ Session-based authentication with Replit Auth
- ✅ PostgreSQL database with Drizzle ORM
- ✅ Professional UI with responsive design
- ✅ Real-time threat analysis and visualization

## Post-Deployment

After successful deployment:
1. Test authentication flow
2. Upload sample log files
3. Verify all analytics features work
4. Test anomaly detection with AI analysis
5. Check that all navigation and filtering works correctly